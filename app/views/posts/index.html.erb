<div id="blog-index">
  <h1>Blog</h1>

  <% if current_user && current_user.admin? %>
    <%= link_to "New post", new_post_path %>
  <% end %>

  <% if @posts.any? %>
    <% @posts.each do |post| %>
      <div id="blog-title">
        <h3><%= link_to post.post_title, post_path(post) %></h3>
        <h4><%= post.created_at.time.strftime "%B %d, %Y" %></h4>
      </div>
      <%= image_tag post.attached_image.url(:medium), id: "blog-pic" %>
      <p><%= post.post_content %></p>

      <h3>Total Comments: <%= post.comments.length %> |

      <% if current_user %>
        <%= link_to "Add a comment", new_post_comment_path(post), id: "new_comment_link", remote: true %>
      <% else %>
        <p><%= link_to "Sign in to post comments.", new_user_session_path %></p>
      <% end %></h3>

      <div id="comments">
        <% if post.comments.any? %>
          <% if current_user && current_user.admin? %>
            <% post.comments.each do |comment| %>
              <p><%= comment.comment_content %>  <strong>-<%= comment.comment_author %></strong><%= link_to "X", post_comment_path(post, comment),
              :data => {:confirm => "Are you sure you want to delete this comment?",
              :method => "delete"} %></p>
            <% end %>
          <% else %>
              <% post.comments.each do |comment| %>
                <p><%= comment.comment_content %>  <strong>-<%= comment.comment_author %></strong></p>
              <% end %>
          <% end %>
        <% end %>
      </div>


      <br><br>
    <% end %>
  <% end %>
</div>
